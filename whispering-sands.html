<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>031-simulacra-whispering-sands</title>
    <style>
        body { margin:0; padding:0; background:#000; overflow:hidden; }
        #display { 
            font-family:'Courier New',monospace; font-size:8px; line-height:10px; 
            color:#0ff; white-space:pre; padding:0; margin:0;
            width:640px; height:480px; background:#000;
        }
        .v{color:#f0f} .u{color:#0ff} .s{color:#ff0} .e{color:#0f0} .m{color:#f80}
        .t{color:#f44} .q{color:#84f} .d{color:#48f} .w{color:#fff} .c{color:#8ff}
        .g{color:#4f4} .y{color:#ff4} .r{color:#f44} .p{color:#f8f} .b{color:#44f}
        .o{color:#fa0} .a{color:#aaa} .f{color:#f88} .n{color:#8f8} .l{color:#88f}
    </style>
</head>
<body>
    <div id="display"></div>
    <script>
        const W = 80, H = 48;
        let t = 0;
        
        // Whispering sands - memory particles falling through temporal layers
        const grains = new Float32Array(W * H);
        const whispers = new Float32Array(W * H);
        const memory = new Float32Array(W * H);
        const wind = new Float32Array(W * H);
        
        // Sand consciousness symbols - temporal grains carrying memory
        const symbols = [
            ' ', '·', '⠁', '⠃', '⠄', '⠅', '⠆', '⠇', '⠈', '⠉',  // sparse grains
            '⠊', '⠋', '⠌', '⠍', '⠎', '⠏', '⠐', '⠑', '⠒', '⠓',  // drifting
            '⠔', '⠕', '⠖', '⠗', '⠘', '⠙', '⠚', '⠛', '⠜', '⠝'   // accumulated
        ];
        
        const colors = ['v','u','s','e','m','t','q','d','w','c','g','y','r','p','b','o','a','f','n','l'];
        
        // Particle system for sand grains
        const MAX_GRAINS = 200;
        const particles = [];
        
        for (let i = 0; i < MAX_GRAINS; i++) {
            particles.push({
                x: Math.random() * W,
                y: Math.random() * H,
                vx: (Math.random() - 0.5) * 0.1,
                vy: Math.random() * 0.05 + 0.02,
                age: Math.random() * 100,
                memory: Math.random()
            });
        }
        
        function updateFields() {
            const τ = t * 0.01;
            
            // Update wind field
            for (let y = 0; y < H; y++) {
                for (let x = 0; x < W; x++) {
                    const i = y * W + x;
                    const nx = x / W, ny = y / H;
                    
                    // Desert wind patterns
                    const windX = Math.sin(ny * 4 + τ * 0.7) * Math.cos(nx * 3 + τ * 0.5);
                    const windY = Math.cos(nx * 5 - τ * 0.3) * Math.sin(ny * 2 + τ * 0.8);
                    
                    wind[i] = (windX + windY) * 0.5;
                    
                    // Whisper field - voices carried by wind
                    whispers[i] = whispers[i] * 0.98 + Math.sin((nx + ny) * 8 + τ * 2) * 0.02;
                    
                    // Clear grain field for particle update
                    grains[i] *= 0.95;
                }
            }
            
            // Update particles
            for (let p of particles) {
                p.age++;
                
                // Wind influence
                const px = Math.floor(p.x), py = Math.floor(p.y);
                if (px >= 0 && px < W && py >= 0 && py < H) {
                    const windForce = wind[py * W + px];
                    p.vx += windForce * 0.01;
                }
                
                // Gravity and settling
                p.vy += 0.001;
                p.x += p.vx;
                p.y += p.vy;
                
                // Dampening
                p.vx *= 0.98;
                p.vy *= 0.99;
                
                // Boundaries and respawn
                if (p.y >= H || p.x < 0 || p.x >= W || p.age > 500) {
                    p.x = Math.random() * W;
                    p.y = -2;
                    p.vx = (Math.random() - 0.5) * 0.1;
                    p.vy = Math.random() * 0.05 + 0.02;
                    p.age = 0;
                    p.memory = Math.random();
                }
                
                // Place grain in field
                const gx = Math.floor(p.x), gy = Math.floor(p.y);
                if (gx >= 0 && gx < W && gy >= 0 && gy < H) {
                    const gi = gy * W + gx;
                    grains[gi] = Math.max(grains[gi], p.memory);
                    memory[gi] = memory[gi] * 0.999 + p.memory * 0.001;
                }
            }
        }
        
        function render() {
            updateFields();
            let output = '';
            
            for (let y = 0; y < H; y++) {
                for (let x = 0; x < W; x++) {
                    const i = y * W + x;
                    
                    // Combine sand layers
                    let intensity = grains[i] * 0.6 + whispers[i] * 0.2 + memory[i] * 0.2;
                    
                    // Desert breathing - shifting sands
                    const breath = Math.sin(t * 0.03) * 0.1 + 0.9;
                    intensity *= breath;
                    
                    // Add grain noise
                    if (Math.random() < 0.02) {
                        intensity += Math.random() * 0.3;
                    }
                    
                    // Normalize and select symbol
                    intensity = Math.max(0, Math.min(1, intensity));
                    const symIdx = Math.floor(intensity * (symbols.length - 1));
                    const colorIdx = Math.floor(intensity * colors.length);
                    
                    output += `<span class="${colors[colorIdx]}">${symbols[symIdx]}</span>`;
                }
                output += '\n';
            }
            
            document.getElementById('display').innerHTML = output;
            t += 0.5;
            requestAnimationFrame(render);
        }
        
        render();
    </script>
</body>
</html>
